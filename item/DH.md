# 디피-헬만 개인키 탈취 시 공유키 계산

### 1️⃣ 공개 매개변수

- 소수 $p = 17$
- 원시근(generator) $g = 3$

> 숫자를 작게 해서 계산하기 쉽게 했습니다.

---

### 2️⃣ 개인키 선택

- Alice 개인키: $a = 5$
- Bob 개인키: $b = 7$

---

### 3️⃣ 공개키 계산

#### Alice 공개키 $A$

$$
A = g^a \mod p = 3^5 \mod 17
$$

**단계별 계산**:

| 계산                                  | 값  | mod 17 나머지                 |
| ------------------------------------- | --- | ----------------------------- |
| $3^1$                                 | 3   | 3                             |
| $3^2 = 3 \cdot 3$                     | 9   | 9                             |
| $3^4 = 9 \cdot 9$                     | 81  | 81 ÷ 17 → 17×4=68 → 나머지 13 |
| $3^5 = 3^4 \cdot 3 = 13 \cdot 3 = 39$ | 39  | 39 ÷ 17 → 17×2=34 → 나머지 5  |

✅ Alice 공개키: $A = 5$

---

#### Bob 공개키 $B$

$$
B = g^b \mod p = 3^7 \mod 17
$$

**단계별 계산**:

| 계산                                                       | 값  | mod 17 나머지                    |
| ---------------------------------------------------------- | --- | -------------------------------- |
| $3^1 = 3$                                                  | 3   | 3                                |
| $3^2 = 9$                                                  | 9   | 9                                |
| $3^4 = 9 \cdot 9 = 81$                                     | 81  | 81 ÷ 17 → 68 → 나머지 13         |
| $3^7 = 3^4 \cdot 3^2 \cdot 3^1 = 13 \cdot 9 \cdot 3 = 351$ | 351 | 351 ÷ 17 → 17×20=340 → 나머지 11 |

✅ Bob 공개키: $B = 11$

---

### 4️⃣ 공유키 계산

#### Alice 계산

$$
K = B^a \mod p = 11^5 \mod 17
$$

**단계별 계산**:

1. $11^2 = 121$ → 121 ÷ 17 → 17×7=119 → 나머지 2
   → $11^2 \mod 17 = 2$
2. $11^4 = (11^2)^2 = 2^2 = 4$
3. $11^5 = 11^4 \cdot 11 = 4 \cdot 11 = 44$ → 44 ÷ 17 → 17×2=34 → 나머지 10

✅ Alice 공유키: $K = 10$

---

#### Bob 계산

$$
K = A^b \mod p = 5^7 \mod 17
$$

**단계별 계산**:

1. $5^2 = 25$ → 25 ÷ 17 → 17×1=17 → 나머지 8
2. $5^4 = 8^2 = 64$ → 64 ÷ 17 → 17×3=51 → 나머지 13
3. $5^7 = 5^4 \cdot 5^2 \cdot 5^1 = 13 \cdot 8 \cdot 5 = 520$ → 520 ÷ 17 → 17×30=510 → 나머지 10

✅ Bob 공유키: $K = 10$

---

### 5️⃣ 결론

- Alice와 Bob 모두 **동일한 공유키 $K = 10$** 획득
- 숫자가 작아서 직접 계산도 가능하고, **mod 연산 과정을 쉽게 확인**할 수 있습니다.

---
